<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Hazard · SurvivalModels.jl</title><meta name="title" content="General Hazard · SurvivalModels.jl"/><meta property="og:title" content="General Hazard · SurvivalModels.jl"/><meta property="twitter:title" content="General Hazard · SurvivalModels.jl"/><meta name="description" content="Documentation for SurvivalModels.jl."/><meta property="og:description" content="Documentation for SurvivalModels.jl."/><meta property="twitter:description" content="Documentation for SurvivalModels.jl."/><meta property="og:url" content="https://JuliaSurv.github.io/SurvivalModels.jl/parametric/generalhazard/"/><meta property="twitter:url" content="https://JuliaSurv.github.io/SurvivalModels.jl/parametric/generalhazard/"/><link rel="canonical" href="https://JuliaSurv.github.io/SurvivalModels.jl/parametric/generalhazard/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SurvivalModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Nonparametric</span><ul><li><a class="tocitem" href="../../nonparametric/kaplanmeier/">Kaplan-Meier</a></li><li><a class="tocitem" href="../../nonparametric/logranktest/">Log-Rank Test</a></li></ul></li><li><span class="tocitem">Semiparametric</span><ul><li><a class="tocitem" href="../../semiparametric/cox/">Cox</a></li></ul></li><li><span class="tocitem">Parametric</span><ul><li class="is-active"><a class="tocitem" href>General Hazard</a><ul class="internal"><li><a class="tocitem" href="#Hazard-and-cumulative-hazard-functions"><span>Hazard and cumulative hazard functions</span></a></li><li><a class="tocitem" href="#General-Hazard-Models-2"><span>General Hazard Models</span></a></li><li><a class="tocitem" href="#Illustrative-example"><span>Illustrative example</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../case_study/">Case Study</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parametric</a></li><li class="is-active"><a href>General Hazard</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General Hazard</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSurv/SurvivalModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/main/docs/src/parametric/generalhazard.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="General-Hazard-Models"><a class="docs-heading-anchor" href="#General-Hazard-Models">General Hazard Models</a><a id="General-Hazard-Models-1"></a><a class="docs-heading-anchor-permalink" href="#General-Hazard-Models" title="Permalink"></a></h1><h2 id="Hazard-and-cumulative-hazard-functions"><a class="docs-heading-anchor" href="#Hazard-and-cumulative-hazard-functions">Hazard and cumulative hazard functions</a><a id="Hazard-and-cumulative-hazard-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Hazard-and-cumulative-hazard-functions" title="Permalink"></a></h2><p>The hazard and the cumulative hazard functions play a crucial role in survival analysis. These functions define the likelihood function in the presence of censored observations. Thus, they are important in many context. For more information about these functions, see <a href="https://github.com/FJRubio67/ShortCourseParamSurvival">Short course on Parametric Survival Analysis </a>.</p><p>In Julia, hazard and cumulative hazard functions can be fetched through the <code>hazard(dist, t)</code> and <code>cumhaz(dist, t)</code> functions from <code>SurvivalDistributions.jl</code>, and can be aplied to any distributions complient with <code>Distributions.jl</code>&#39;s API. Note that <code>SurvivalDistributions.jl</code> also contains a few more distributions relevant to survival analysis. See also the (deprecated) <a href="https://github.com/FJRubio67/HazReg.jl">HazReg.jl Julia Package</a>. </p><p>Here are a few plots of hazard curves for some known distributions: </p><pre><code class="language-julia hljs">using Distributions, Plots, StatsBase, SurvivalDistributions
function hazard_cumhazard_plot(dist, distname; tlims=(0,10))
      plt1 = plot(t -&gt; hazard(dist, t),
            xlabel = &quot;x&quot;, ylabel = &quot;Hazard&quot;, title = &quot;$distname distribution&quot;,
            xlims = tlims, xticks = tlims[1]:1:tlims[2], label = &quot;&quot;,
            xtickfont = font(16, &quot;Courier&quot;), ytickfont = font(16, &quot;Courier&quot;),
            xguidefontsize=18, yguidefontsize=18, linewidth=3,
            linecolor = &quot;blue&quot;)
      plt2 = plot(t -&gt; cumhazard(dist, t),
            xlabel = &quot;x&quot;, ylabel = &quot;Cumulative Hazard&quot;, title = &quot;$distname distribution&quot;,
            xlims = tlims, xticks = tlims[1]:1:tlims[2], label = &quot;&quot;,
            xtickfont = font(16, &quot;Courier&quot;), ytickfont = font(16, &quot;Courier&quot;),
            xguidefontsize=18, yguidefontsize=18, linewidth=3,
            linecolor = &quot;blue&quot;)
      return plot(plt1, plt2)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">hazard_cumhazard_plot (generic function with 1 method)</code></pre><h3 id="LogNormal"><a class="docs-heading-anchor" href="#LogNormal">LogNormal</a><a id="LogNormal-1"></a><a class="docs-heading-anchor-permalink" href="#LogNormal" title="Permalink"></a></h3><pre><code class="language-julia hljs">hazard_cumhazard_plot(LogNormal(0.5, 1), &quot;LogNormal&quot;)</code></pre><img src="bfada872.svg" alt="Example block output"/><h3 id="LogLogistic"><a class="docs-heading-anchor" href="#LogLogistic">LogLogistic</a><a id="LogLogistic-1"></a><a class="docs-heading-anchor-permalink" href="#LogLogistic" title="Permalink"></a></h3><pre><code class="language-julia hljs">hazard_cumhazard_plot(LogLogistic(1, 0.5), &quot;LogLogistic&quot;)</code></pre><img src="38390aa0.svg" alt="Example block output"/><h3 id="Weibull"><a class="docs-heading-anchor" href="#Weibull">Weibull</a><a id="Weibull-1"></a><a class="docs-heading-anchor-permalink" href="#Weibull" title="Permalink"></a></h3><pre><code class="language-julia hljs">hazard_cumhazard_plot(Weibull(3, 0.5), &quot;Weibull&quot;)</code></pre><img src="becf2770.svg" alt="Example block output"/><h3 id="Gamma"><a class="docs-heading-anchor" href="#Gamma">Gamma</a><a id="Gamma-1"></a><a class="docs-heading-anchor-permalink" href="#Gamma" title="Permalink"></a></h3><pre><code class="language-julia hljs">hazard_cumhazard_plot(Gamma(3, 0.5), &quot;Gamma&quot;)</code></pre><img src="23f91d39.svg" alt="Example block output"/><h2 id="General-Hazard-Models-2"><a class="docs-heading-anchor" href="#General-Hazard-Models-2">General Hazard Models</a><a class="docs-heading-anchor-permalink" href="#General-Hazard-Models-2" title="Permalink"></a></h2><p>The GH model is formulated in terms of the hazard structure</p><p class="math-container">\[h(t; \alpha, \beta, \theta, {\bf x}) = h_0\left(t  \exp\{\tilde{\bf x}^{\top}\alpha\}; \theta\right) \exp\{{\bf x}^{\top}\beta\}.\]</p><p>where <span>${\bf x}\in{\mathbb R}^p$</span> are the covariates that affect the hazard level; <span>$\tilde{\bf x} \in {\mathbb R}^q$</span> are the covariates the affect the time level (typically <span>$\tilde{\bf x} \subset {\bf x}$</span>); <span>$\alpha \in {\mathbb R}^q$</span> and <span>$\beta \in {\mathbb R}^p$</span> are the regression coefficients; and <span>$\theta \in \Theta$</span> is the vector of parameters of the baseline hazard <span>$h_0(\cdot)$</span>.</p><p>This hazard structure leads to an identifiable model as long as the baseline hazard is not a hazard associated to a member of the Weibull family of distributions [<a href="../../references/#chen_2001">5</a>]. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurvivalModels.GeneralHazardModel" href="#SurvivalModels.GeneralHazardModel"><code>SurvivalModels.GeneralHazardModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GeneralHazardModel{Method, B}</code></pre><p>A flexible parametric survival model supporting Proportional Hazards (PH), Accelerated Failure Time (AFT), Accelerated Hazards (AH), and General Hazards (GH) structures.</p><p><strong>Fields</strong></p><ul><li><code>T</code>: Vector of observed times.</li><li><code>Δ</code>: Vector of event indicators (true if event, false if censored).</li><li><code>baseline</code>: Baseline distribution (e.g., <code>Weibull()</code>).</li><li><code>X1</code>: Covariate matrix for the first linear predictor (e.g., PH/AFT).</li><li><code>X2</code>: Covariate matrix for the second linear predictor (e.g., AH/GH).</li><li><code>α</code>: Coefficient vector for <code>X2</code>.</li><li><code>β</code>: Coefficient vector for <code>X1</code>.</li></ul><p><strong>Construction</strong></p><p>You can construct a model directly by providing all parameters:</p><pre><code class="language-julia hljs">model = GeneralHazardModel(
    GHMethod(),
    T, Δ, Weibull(1.0, 2.0),
    X1, X2,
    α, β
)</code></pre><p>or fit it from data using the <code>fit</code> interface.</p><p>Supported methods: </p><ul><li><code>ProportionalHazard</code>: For PH models.</li><li><code>AcceleratedFaillureTime</code>: For AFT models.</li><li><code>AcceleratedHazard</code>: For AH models.</li><li><code>GeneralHazard</code>: For full GH models.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/17d2409baf4bcfdcbc251a433ff9821c2352a19d/src/Parametric/GeneralHazard.jl#L17-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurvivalModels.GeneralHazard" href="#SurvivalModels.GeneralHazard"><code>SurvivalModels.GeneralHazard</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GeneralHazard(T, Δ, baseline, X1, X2)
fit(GeneralHazard, @formula(Surv(T, Δ) ~ x1 + x2), @formula(Surv(T, Δ) ~ z1 + z2), df)
fit(GeneralHazard, @formula(Surv(T, Δ) ~ x1 + x2), df)</code></pre><p>Fit a General Hazard (GH) model with a specified baseline distribution and covariates.</p><p><strong>Hazard function</strong></p><p class="math-container">\[h(t \,|\, x, z) = h_0\left(t \exp(z^\top \alpha)\right) \exp(x^\top \beta)\]</p><p>Maximum likelihood estimation in General Hazards models using provided <code>baseline</code> distribution, provided hazard structure (through the <code>method</code> argument), provided design matrices.. </p><p>Parameters <code>T,Δ</code> represent observed times and statuses, while <code>X1, X2</code> should contain covariates. The number of columns in design matrices can be zero. </p><p>Hazard structures are defined by the method, which should be <code>&lt;:AbstractGHMethod</code>, available possibilities are <code>PHMethod()</code>, <code>AFTMethod()</code>, <code>AHMethod()</code> and <code>GHMethod()</code>.</p><p>The baseline distribution should be provided as a <code>&lt;:Distributions.ContinuousUnivariateDistribution</code> object from <code>Distributions.jl</code> or compliant, e.g. from <code>SurvivalDistributions.jl</code>.</p><ul><li><code>T</code>: Vector of observed times.</li><li><code>Δ</code>: Vector of event indicators (1=event, 0=censored).</li><li><code>baseline</code>: Baseline distribution (e.g., Weibull()).</li><li><code>X1</code>, <code>X2</code>: Covariate matrices.</li></ul><p>You can also use the <code>fit()</code> interface with:</p><ul><li>Two formulas (for <code>X1</code> and <code>X2</code>): for full GH models.</li><li>One formula: for PH, AFT, or AH models (the unused matrix will be ignored).</li></ul><p><strong>Example: Direct usage</strong></p><pre><code class="language-julia hljs">using SurvivalModels, Distributions, Optim
T = [2.0, 3.0, 4.0, 5.0, 8.0]
Δ = [1, 1, 0, 1, 0]
X1 = [1.0 2.0; 2.0 1.0; 3.0 1.0; 4.0 2.0; 5.0 1.0]
X2 = [1.0 0.0; 0.0 1.0; 1.0 1.0; 0.0 0.0; 1.0 1.0]
model = GeneralHazard(T, Δ, Weibull, X1, X2)</code></pre><p><strong>Example: Using the fit() interface</strong></p><pre><code class="language-julia hljs">using SurvivalModels, DataFrames, Distributions, Optim, StatsModels
df = DataFrame(time=T, status=Δ, x1=X1[:,1], x2=X1[:,2], z1=X2[:,1], z2=X2[:,2])
model = fit(GeneralHazard, @formula(Surv(time, status) ~ x1 + x2), @formula(Surv(time, status) ~ z1 + z2), df)
# Or for PH/AFT/AH models:
model_ph = fit(ProportionalHazard, @formula(Surv(time, status) ~ x1 + x2), df)</code></pre><p>References: </p><ul><li><a href="https://myref.com">Link to my reference so that people understand what it is</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/17d2409baf4bcfdcbc251a433ff9821c2352a19d/src/Parametric/GeneralHazard.jl#L162-L215">source</a></section></article><h3 id="Accelerated-Failure-Time-(AFT)-model"><a class="docs-heading-anchor" href="#Accelerated-Failure-Time-(AFT)-model">Accelerated Failure Time (AFT) model</a><a id="Accelerated-Failure-Time-(AFT)-model-1"></a><a class="docs-heading-anchor-permalink" href="#Accelerated-Failure-Time-(AFT)-model" title="Permalink"></a></h3><p>The AFT model is formulated in terms of the hazard structure</p><p class="math-container">\[h(t; \beta, \theta, {\bf x}) = h_0\left(t  \exp\{{\bf x}^{\top}\beta\}; \theta\right) \exp\{{\bf x}^{\top}\beta\}.\]</p><p>where <span>${\bf x}\in{\mathbb R}^p$</span> are the available covariates; <span>$\beta \in {\mathbb R}^p$</span> are the regression coefficients; and <span>$\theta \in \Theta$</span> is the vector of parameters of the baseline hazard <span>$h_0(\cdot)$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurvivalModels.AcceleratedFaillureTime" href="#SurvivalModels.AcceleratedFaillureTime"><code>SurvivalModels.AcceleratedFaillureTime</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AcceleratedFaillureTime(T, Δ, baseline, X1, X2)
fit(AcceleratedFaillureTime, @formula(Surv(T, Δ) ~ x1 + x2), df)</code></pre><p>Fit an Accelerated Failure Time (AFT) model with a specified baseline distribution and covariates.</p><p><strong>Hazard function</strong></p><p class="math-container">\[h(t \,|\, x) = h_0\left(t \exp(x^\top \beta)\right) \exp(x^\top \beta)\]</p><ul><li><code>T</code>: Vector of observed times.</li><li><code>Δ</code>: Vector of event indicators (1=event, 0=censored).</li><li><code>baseline</code>: Baseline distribution (e.g., Weibull()).</li><li><code>X1</code>, <code>X2</code>: Covariate matrices (only <code>X1</code> is used in AFT).</li></ul><p>You can also use the <code>fit()</code> interface with a formula and DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/17d2409baf4bcfdcbc251a433ff9821c2352a19d/src/Parametric/GeneralHazard.jl#L118-L136">source</a></section></article><h3 id="Proportional-Hazards-(PH)-model"><a class="docs-heading-anchor" href="#Proportional-Hazards-(PH)-model">Proportional Hazards (PH) model</a><a id="Proportional-Hazards-(PH)-model-1"></a><a class="docs-heading-anchor-permalink" href="#Proportional-Hazards-(PH)-model" title="Permalink"></a></h3><p>The PH model is formulated in terms of the hazard structure</p><p class="math-container">\[h(t; \beta, \theta, {\bf x}) = h_0\left(t ; \theta\right) \exp\{{\bf x}^{\top}\beta\}.\]</p><p>where <span>${\bf x}\in{\mathbb R}^p$</span> are the available covariates; <span>$\beta \in {\mathbb R}^p$</span> are the regression coefficients; and <span>$\theta \in \Theta$</span> is the vector of parameters of the baseline hazard <span>$h_0(\cdot)$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurvivalModels.ProportionalHazard" href="#SurvivalModels.ProportionalHazard"><code>SurvivalModels.ProportionalHazard</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProportionalHazard(T, Δ, baseline, X1, X2)
fit(ProportionalHazard, @formula(Surv(T, Δ) ~ x1 + x2), df)</code></pre><p>Fit a Proportional Hazards (PH) model with a specified baseline distribution and covariates.</p><p><strong>Hazard function</strong></p><p class="math-container">\[h(t \,|\, x) = h_0(t) \exp(x^\top \beta)\]</p><ul><li><code>T</code>: Vector of observed times.</li><li><code>Δ</code>: Vector of event indicators (1=event, 0=censored).</li><li><code>baseline</code>: Baseline distribution (e.g., Weibull()).</li><li><code>X1</code>, <code>X2</code>: Covariate matrices (only <code>X1</code> is used in PH).</li></ul><p>You can also use the <code>fit()</code> interface with a formula and DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/17d2409baf4bcfdcbc251a433ff9821c2352a19d/src/Parametric/GeneralHazard.jl#L96-L114">source</a></section></article><h3 id="Accelerated-Hazards-(AH)-model"><a class="docs-heading-anchor" href="#Accelerated-Hazards-(AH)-model">Accelerated Hazards (AH) model</a><a id="Accelerated-Hazards-(AH)-model-1"></a><a class="docs-heading-anchor-permalink" href="#Accelerated-Hazards-(AH)-model" title="Permalink"></a></h3><p>The AH model is formulated in terms of the hazard structure</p><p class="math-container">\[h(t; \alpha, \theta, \tilde{\bf x}) = h_0\left(t \exp\{\tilde{\bf x}^{\top}\alpha\}; \theta\right) .\]</p><p>where <span>$\tilde{\bf x}\in{\mathbb R}^q$</span> are the available covariates; <span>$\alpha \in {\mathbb R}^q$</span> are the regression coefficients; and <span>$\theta \in \Theta$</span> is the vector of parameters of the baseline hazard <span>$h_0(\cdot)$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurvivalModels.AcceleratedHazard" href="#SurvivalModels.AcceleratedHazard"><code>SurvivalModels.AcceleratedHazard</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AcceleratedHazard(T, Δ, baseline, X1, X2)
fit(AcceleratedHazard, @formula(Surv(T, Δ) ~ x1 + x2), df)</code></pre><p>Fit an Accelerated Hazard (AH) model with a specified baseline distribution and covariates.</p><p><strong>Hazard function</strong></p><p class="math-container">\[h(t \,|\, z) = h_0\left(t \exp(z^\top \alpha)\right)\]</p><ul><li><code>T</code>: Vector of observed times.</li><li><code>Δ</code>: Vector of event indicators (1=event, 0=censored).</li><li><code>baseline</code>: Baseline distribution (e.g., Weibull()).</li><li><code>X1</code>, <code>X2</code>: Covariate matrices (only <code>X2</code> is used in AH).</li></ul><p>You can also use the <code>fit()</code> interface with a formula and DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/17d2409baf4bcfdcbc251a433ff9821c2352a19d/src/Parametric/GeneralHazard.jl#L140-L158">source</a></section></article><h3 id="Available-baseline-hazards"><a class="docs-heading-anchor" href="#Available-baseline-hazards">Available baseline hazards</a><a id="Available-baseline-hazards-1"></a><a class="docs-heading-anchor-permalink" href="#Available-baseline-hazards" title="Permalink"></a></h3><p>The current version of the <code>simGH</code> command implements the following parametric baseline hazards for the models discussed in the previous section.</p><ul><li><p><a href="http://rpubs.com/FJRubio/PGW">Power Generalised Weibull</a> (PGW) distribution.</p></li><li><p><a href="http://rpubs.com/FJRubio/EWD">Exponentiated Weibull</a> (EW) distribution.</p></li><li><p><a href="http://rpubs.com/FJRubio/GG">Generalised Gamma</a> (GenGamma) distribuiton.</p></li><li><p><a href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma</a> (Gamma) distribution.</p></li><li><p><a href="https://en.wikipedia.org/wiki/Log-normal_distribution">Lognormal</a> (LogNormal) distribution.</p></li><li><p><a href="https://en.wikipedia.org/wiki/Log-logistic_distribution">Log-logistic</a> (LogLogistic) distribution.</p></li><li><p><a href="https://en.wikipedia.org/wiki/Weibull_distribution">Weibull</a> (Weibull) distribution. (only for AFT, PH, and AH models)</p></li></ul><h3 id="Simulating-times-to-event-from-a-general-hazard-structure-with-simGH"><a class="docs-heading-anchor" href="#Simulating-times-to-event-from-a-general-hazard-structure-with-simGH">Simulating times to event from a general hazard structure with <code>simGH</code></a><a id="Simulating-times-to-event-from-a-general-hazard-structure-with-simGH-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-times-to-event-from-a-general-hazard-structure-with-simGH" title="Permalink"></a></h3><p>The simGH command from the <code>HazReg.jl</code> Julia package allows one to simulate times to event from the following models:</p><ul><li>General Hazard (GH) model [<a href="../../references/#chen_2001">5</a>] [<a href="../../references/#rubio_2019">6</a>].</li><li>Accelerated Failure Time (AFT) model [<a href="../../references/#kalbfleisch_2011">7</a>].</li><li>Proportional Hazards (PH) model [<a href="../../references/#cox_1972">8</a>].</li><li>Accelerated Hazards (AH) model [<a href="../../references/#chen_2000">9</a>].</li></ul><p>A description of these hazard models is presented below as well as the available baseline hazards.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurvivalModels.simGH" href="#SurvivalModels.simGH"><code>SurvivalModels.simGH</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simGH(n, model::GeneralHazardModel)</code></pre><p>This function simulate times to event from a general hazard model, whatever the structure it has (AH, AFT, PH, GH), and whatever its baseline distribution. </p><p>Returns a vector containing the simulated times to event</p><p>References: </p><ul><li><a href="https://github.com/FJRubio67/HazReg">HazReg original code</a> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/SurvivalModels.jl/blob/17d2409baf4bcfdcbc251a433ff9821c2352a19d/src/Parametric/GeneralHazard.jl#L243-L252">source</a></section></article><h2 id="Illustrative-example"><a class="docs-heading-anchor" href="#Illustrative-example">Illustrative example</a><a id="Illustrative-example-1"></a><a class="docs-heading-anchor-permalink" href="#Illustrative-example" title="Permalink"></a></h2><p>In this example, we simulate <span>$n=1,000$</span> times to event from the GH, PH, AFT, and AH models with PGW baseline hazards, using the <code>simGH()</code> function. This functionality was ported from <a href="https://github.com/FJRubio67/HazReg.jl">HazReg.jl</a> </p><h3 id="PGW-GH-model"><a class="docs-heading-anchor" href="#PGW-GH-model">PGW-GH model</a><a id="PGW-GH-model-1"></a><a class="docs-heading-anchor-permalink" href="#PGW-GH-model" title="Permalink"></a></h3><pre><code class="language-julia hljs">using SurvivalModels, Distributions, DataFrames, Random, SurvivalDistributions
using SurvivalModels: simGH

# Simulte design matrices
n = 1000
Random.seed!(123)
des = randn(n, 2)
des_t = randn(n, 2)

# True parameters
theta0 = [0.1, 2.0, 5.0]
alpha0 = [0.5, 0.8]
beta0 = [-0.5, 0.75]

# Construct the model directly (no optimization)
model = GeneralHazard(zeros(n), trues(n),
    PowerGeneralizedWeibull(theta0...),
    des, des_t, alpha0, beta0)

# Simulate event times
simdat = simGH(n, model)

# Administrative censoring.
cens = 10
status = simdat .&lt; cens
simdat = min.(simdat, cens)

# Model fit from dataframe interface.
df = DataFrame(time=simdat, status=status, x1=des[:,1], x2=des[:,2], z1=des_t[:,1], z2=des_t[:,2])
model = fit(GeneralHazard{PowerGeneralizedWeibull},
    @formula(Surv(time, status) ~ x1 + x2),
    @formula(Surv(time, status) ~ z1 + z2),
    df)

result = DataFrame(
    Parameter = [&quot;θ₁&quot;, &quot;θ₂&quot;, &quot;θ₃&quot;, &quot;α₁&quot;, &quot;α₂&quot;,&quot;β₁&quot;, &quot;β₂&quot;],
    True      = vcat(theta0, alpha0, beta0),
    Fitted    = vcat(params(model.baseline)..., model.α, model.β)
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Parameter</th><th style = "text-align: left;">True</th><th style = "text-align: left;">Fitted</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ₁</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">0.0976878</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ₂</td><td style = "text-align: right;">2.0</td><td style = "text-align: right;">2.11389</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">θ₃</td><td style = "text-align: right;">5.0</td><td style = "text-align: right;">5.16631</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">α₁</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">0.50072</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">α₂</td><td style = "text-align: right;">0.8</td><td style = "text-align: right;">0.746287</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">β₁</td><td style = "text-align: right;">-0.5</td><td style = "text-align: right;">-0.55193</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">β₂</td><td style = "text-align: right;">0.75</td><td style = "text-align: right;">0.729065</td></tr></tbody></table></div><p>Of course, increasing hte numebr of observations would increase the quality of the fitted values. You can also use &quot;subset&quot; models (PH, AH, AFT) through the convenient constructors as follows: </p><h3 id="PGW-PH-model"><a class="docs-heading-anchor" href="#PGW-PH-model">PGW-PH model</a><a id="PGW-PH-model-1"></a><a class="docs-heading-anchor-permalink" href="#PGW-PH-model" title="Permalink"></a></h3><pre><code class="language-julia hljs">model = ProportionalHazard(zeros(n), trues(n),
    PowerGeneralizedWeibull(theta0...),
    des, zeros(n,0),  # X2 is empty for PH
    zeros(0), beta0
)

# Simulate event times and censor them
simdat = simGH(n, model)
cens = 10
status = simdat .&lt; cens
simdat = min.(simdat, cens)


# Build the model and fit it:
df = DataFrame(time=simdat, status=status, x1=des[:,1], x2=des[:,2])
model = fit(ProportionalHazard{PowerGeneralizedWeibull},
    @formula(Surv(time, status) ~ x1 + x2), df)

result = DataFrame(
    Parameter = [&quot;θ₁&quot;, &quot;θ₂&quot;, &quot;θ₃&quot;, &quot;β₁&quot;, &quot;β₂&quot;],
    True      = vcat(theta0, beta0),
    Fitted    = vcat(params(model.baseline)..., model.β)
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Parameter</th><th style = "text-align: left;">True</th><th style = "text-align: left;">Fitted</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ₁</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">0.105441</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ₂</td><td style = "text-align: right;">2.0</td><td style = "text-align: right;">1.98049</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">θ₃</td><td style = "text-align: right;">5.0</td><td style = "text-align: right;">4.83453</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">β₁</td><td style = "text-align: right;">-0.5</td><td style = "text-align: right;">-0.489229</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">β₂</td><td style = "text-align: right;">0.75</td><td style = "text-align: right;">0.747127</td></tr></tbody></table></div><h3 id="PGW-AFT-model"><a class="docs-heading-anchor" href="#PGW-AFT-model">PGW-AFT model</a><a id="PGW-AFT-model-1"></a><a class="docs-heading-anchor-permalink" href="#PGW-AFT-model" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Construct the model directly (no optimization)
model = AcceleratedFaillureTime(
    zeros(n), trues(n), PowerGeneralizedWeibull(theta0...),
    des, zeros(n,0),  # X2 is empty for AFT
    zeros(0), beta0
)

# Simulate event times
simdat = simGH(n, model)

# Censoring
cens = 10
status = simdat .&lt; cens
simdat = min.(simdat, cens)

df = DataFrame(time=simdat, status=status, x1=des[:,1], x2=des[:,2])
model = fit(AcceleratedFaillureTime{PowerGeneralizedWeibull},
    @formula(Surv(time, status) ~ x1 + x2), df)

result = DataFrame(
    Parameter = [&quot;θ₁&quot;, &quot;θ₂&quot;, &quot;θ₃&quot;, &quot;β₁&quot;, &quot;β₂&quot;],
    True      = vcat(theta0, beta0),
    Fitted    = vcat(params(model.baseline)..., model.β)
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Parameter</th><th style = "text-align: left;">True</th><th style = "text-align: left;">Fitted</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ₁</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">0.115202</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ₂</td><td style = "text-align: right;">2.0</td><td style = "text-align: right;">2.00523</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">θ₃</td><td style = "text-align: right;">5.0</td><td style = "text-align: right;">4.93252</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">β₁</td><td style = "text-align: right;">-0.5</td><td style = "text-align: right;">-0.472378</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">β₂</td><td style = "text-align: right;">0.75</td><td style = "text-align: right;">0.773327</td></tr></tbody></table></div><h3 id="PGW-AH-model"><a class="docs-heading-anchor" href="#PGW-AH-model">PGW-AH model</a><a id="PGW-AH-model-1"></a><a class="docs-heading-anchor-permalink" href="#PGW-AH-model" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Construct the model directly (no optimization)
model = AcceleratedHazard(zeros(n), trues(n),
    PowerGeneralizedWeibull(theta0...),
    zeros(n,0), des_t,  # X1 is empty for AH
    alpha0, zeros(0)
)

# Simulate event times
simdat = simGH(n, model)
cens = 10
status = simdat .&lt; cens
simdat = min.(simdat, cens)

df = DataFrame(time=simdat, status=status, z1=des_t[:,1], z2=des_t[:,2])
model = fit(AcceleratedHazard{PowerGeneralizedWeibull},
    @formula(Surv(time, status) ~ z1 + z2), df)

result = DataFrame(
    Parameter = [&quot;θ₁&quot;, &quot;θ₂&quot;, &quot;θ₃&quot;, &quot;α₁&quot;, &quot;α₂&quot;],
    True      = vcat(theta0, alpha0),
    Fitted    = vcat(params(model.baseline)..., model.α)
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Parameter</th><th style = "text-align: left;">True</th><th style = "text-align: left;">Fitted</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ₁</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">0.102682</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ₂</td><td style = "text-align: right;">2.0</td><td style = "text-align: right;">1.9515</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">θ₃</td><td style = "text-align: right;">5.0</td><td style = "text-align: right;">4.86784</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">α₁</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">0.547098</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">α₂</td><td style = "text-align: right;">0.8</td><td style = "text-align: right;">0.738173</td></tr></tbody></table></div><div class="citation noncanonical"><dl><dt>[5]</dt><dd><div>Y. Chen and N. Jewell. <em>On a general class of semiparametric hazards regression models</em>. Biometrika <strong>88</strong>, 687–702 (2001).</div></dd><dt>[6]</dt><dd><div>F. Rubio, L. Remontet, N. Jewell and A. Belot. <em>On a general structure for hazard-based regression models: an application to population-based cancer research</em>. Statistical Methods in Medical Research <strong>28</strong>, 2404–2417 (2019).</div></dd><dt>[7]</dt><dd><div>J. Kalbfleisch and R. Prentice. <em>The statistical analysis of failure time data</em> (John Wiley &amp; Sons, 2011).</div></dd><dt>[8]</dt><dd><div>D. Cox. <em>Regression models and life-tables</em>. Journal of the Royal Statistical Society: Series B (Methodological) <strong>34</strong>, 187–202 (1972).</div></dd><dt>[9]</dt><dd><div>Y. Chen and M. Wang. <em>Analysis of accelerated hazards models</em>. Journal of the American Statistical Association <strong>95</strong>, 608–618 (2000).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../semiparametric/cox/">« Cox</a><a class="docs-footer-nextpage" href="../../case_study/">Case Study »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 16 July 2025 16:10">Wednesday 16 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
